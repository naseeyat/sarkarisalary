<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Component Test - WBSSC SLST 2025</title>

    <!-- Global JS (handles header scroll) -->
    <script src="/shared/global.js"></script>

    <link rel="stylesheet" href="/shared/brutalist-styles.css">
    <link rel="stylesheet" href="/shared/header-footer.css">

    <style>
        body {
            font-family: ui-monospace, SFMono-Regular, "SF Mono", Consolas, "Liberation Mono", Menlo, monospace;
            background: #ffffff;
            color: #333333;
            line-height: 1.6;
            font-size: 14px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Job Alert Styles */
        .job-alert {
            border: 3px solid #333333;
            padding: 15px 0;
            margin-bottom: 30px;
            text-align: center;
            font-weight: 900;
            font-size: 14px;
            letter-spacing: 1px;
        }

        .job-alert.active {
            background: #00aa00;
            color: #ffffff;
        }

        .job-alert.closed {
            background: #ff4444;
            color: #ffffff;
        }

        .alert-container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* Sticky alert positioning */
        .job-alert {
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 3px solid #333333;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div id="header"></div>

    <div class="container" style="max-width: 900px; margin: 0 auto; padding: 20px;">
        <!-- Alert Banner (sticky) -->
        <div id="job-alert"></div>

        <!-- Components will be injected here -->
        <div id="job-components"></div>

        <!-- Manual content section (example) -->
        <div style="margin: 40px 0; border: 3px solid #333; padding: 30px; background: #f8f8f8;">
            <h2 style="font-size: 20px; font-weight: 900; margin-bottom: 15px; text-transform: uppercase;">
                üìã ELIGIBILITY CRITERIA (Manual Section)
            </h2>
            <p style="font-size: 14px; line-height: 1.8; margin-bottom: 10px;">
                This section is manually written and stays the same.
                Components handle repetitive data-driven sections above.
            </p>
            <ul style="margin: 10px 0 10px 20px; line-height: 1.8;">
                <li>Educational Qualification: As per notification</li>
                <li>Age Limit: 18-40 years</li>
                <li>Nationality: Indian</li>
            </ul>
        </div>
    </div>

    <!-- Footer -->
    <div id="footer"></div>

    <!-- Load header/footer -->
    <script>
        fetch('/shared/header.html')
            .then(r => r.text())
            .then(html => {
                document.getElementById('header').innerHTML = html;
            });

        fetch('/shared/footer.html')
            .then(r => r.text())
            .then(html => {
                document.getElementById('footer').innerHTML = html;
            });
    </script>

    <!-- Component Library -->
    <script src="/shared/components.js"></script>

    <!-- Initialize Components -->
    <script>
        // Fetch job data and render
        fetch('/data/jobs.json')
            .then(response => response.json())
            .then(data => {
                // Get WBSSC job for testing
                const job = data.jobs.find(j => j.slug === 'wbssc-slst-2025');

                if (!job) {
                    document.getElementById('job-components').innerHTML = '<p style="color: red;">Job not found!</p>';
                    return;
                }

                // Render alert separately (sticky at top)
                document.getElementById('job-alert').innerHTML = renderJobAlert(job);

                // Render all other components (exclude alert since it's already rendered)
                const componentsHTML = renderJobPage(job, { header: true });
                document.getElementById('job-components').innerHTML = componentsHTML;

                console.log('‚úÖ Components rendered successfully');
                console.log('Job data:', job);
            })
            .catch(err => {
                console.error('‚ùå Error loading job data:', err);
                document.getElementById('job-components').innerHTML = `
                    <div style="background: #ff4444; color: #fff; padding: 20px; border: 3px solid #333;">
                        <h3>Error loading job data</h3>
                        <p>${err.message}</p>
                    </div>
                `;
            });
    </script>
</body>
</html>
